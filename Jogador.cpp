//############################################################################################################################################
#include "Jogador.h"
//############################################################################################################################################

//############################################################################################################################################
Jogador::Jogador(){
	this->status=false;
	this->jogando=false;

	this->cerebrosTotal=0;
	this->cerebrosParcial=0;
	this->tiros=0;
	this->vida=0;
}
//############################################################################################################################################

//############################################################################################################################################
Jogador::~Jogador(){}
//############################################################################################################################################

//############################################################################################################################################
void Jogador::initialize(string nome, string control){
	this->nome=nome;
	this->control=control;

	this->status=true;
	this->jogando=true;

	this->cerebrosTotal=0;
	this->cerebrosParcial=0;
	this->tiros=0;
	this->vida=3;

	for(int i=0; i<10; i++){ table[i]=-1; }
}
//############################################################################################################################################

//############################################################################################################################################
void Jogador::restart(){
	this->jogando=true;

	this->cerebrosTotal=0;
	this->cerebrosParcial=0;
	this->tiros=0;
	this->vida=3;

	for(int i=0; i<10; i++){ table[i]=-1; }
}
//############################################################################################################################################

//############################################################################################################################################
void Jogador::clear(){
	this->status=false;
	this->jogando=false;

	this->cerebrosTotal=0;
	this->cerebrosParcial=0;
	this->tiros=0;
	this->vida=3;

	for(int i=0; i<10; i++){ table[i]=-1; }
}
//############################################################################################################################################

//############################################################################################################################################
void Jogador::eliminar(){
	this->jogando=false; 
}
//############################################################################################################################################

//############################################################################################################################################
bool Jogador::getStatus(){
	return status; 
}
//############################################################################################################################################

//############################################################################################################################################
bool Jogador::getJogando(){
	return this->jogando; 
}
//############################################################################################################################################

//############################################################################################################################################
string Jogador::getNome(){
	return this->nome;
}
//############################################################################################################################################

//############################################################################################################################################
void Jogador::setNome(string nome){
	this->nome=nome;
}
//############################################################################################################################################

//############################################################################################################################################
int Jogador::getHand(int pos){
	return this->hand[pos];
}
//############################################################################################################################################

//############################################################################################################################################
int Jogador::getTable(int pos){
	return this->table[pos]; 
}
//############################################################################################################################################

//############################################################################################################################################
string Jogador::getDadoTipo(int dado){
	return this->pote.getDadoTipo(dado);
}
//############################################################################################################################################

//############################################################################################################################################
string Jogador::getDadoFace(int dado){
	return this->pote.getDadoFace(dado); 
}
//############################################################################################################################################

//############################################################################################################################################
string Jogador::getDadoLocal(int dado){
	return this->pote.getDadoLocal(dado); 
}
//############################################################################################################################################

//############################################################################################################################################
void Jogador::roundStart(){
	
	//JOGADOR
	this->cerebrosParcial=0;
	this->tiros=0;
	this->autoPlayDelay=0;
	
	//POTE
	pote.start();
	
	//HAND
	for(int i=0; i<3; i++){ hand[i]=-1; }
	
	//TABLE
	for(int i=0; i<10; i++){ table[i]=-1; }
}
//############################################################################################################################################

//############################################################################################################################################
void Jogador::roundStop(){
	//DEAD
	if(this->roundCheckEnd()){
		this->cerebrosTotal-=this->cerebrosParcial; }

	this->cerebrosParcial=0;

	//SOUND FX
	extern Som soundDado[3];
	for(int i=0; i<3; i++){ soundDado[i].parar(); }
}
//############################################################################################################################################

//############################################################################################################################################
bool Jogador::roundCheckEnd(){
	if(this->tiros >= this->vida){
		return true; }

	return false;
}
//############################################################################################################################################

//############################################################################################################################################
void Jogador::roundContinue(){
	
	//HAND -> TABLE
	for(int i=0; i<3; i++){ if(hand[i]!=-1 && pote.getDadoFace(hand[i])!="FUGA"){
		for(int x=0; x<10; x++){ if(table[x]==-1){
			pote.setDadoLocal(hand[i], "TABLE");
			table[x]=hand[i];
			break;
		}}
		hand[i]=-1;
	}}

	//POTE -> HAND
	for(int i=0; i<3; i++){ if(hand[i]==-1){
		
		if(pote.getDadosDisponiveis()<1){
			//TABLE
			for(int x=0; x<10; x++){ table[x]=-1; }
			//POTE
			pote.refill();
		}
		
		hand[i]=pote.getDadoRandom();
	}}

	//HAND ROLL
	for(int i=0; i<3; i++){if(hand[i]>-1){  pote.dadoRoll(hand[i], i); }}
	
	//SCORE
	for(int i=0; i<3; i++){ if(hand[i]>-1){
		if(pote.getDadoFace(hand[i])=="TIRO"){
			this->tiros++; }
		if(pote.getDadoFace(hand[i])=="CEREBRO"){
			this->cerebrosParcial++;
			this->cerebrosTotal++; }
	}}
}
//############################################################################################################################################

//############################################################################################################################################
int Jogador::autoPlay(){

	//CONTROL: HUMANO
	if(this->control=="HUMANO"){ return -1; }

	//PRESS ENTER: PC | HUMAN
	this->autoPlayDelay++;
	if(autoPlayDelay>250 || gTeclado.pressionou[TECLA_ENTER]){
		autoPlayDelay=0;   gTeclado.pressionou[TECLA_ENTER]=true; }
	
	//PARAR (DEAD)
	if(this->roundCheckEnd()){
		return 1; }
	
	//PARAR (GANHAR)
	if(cerebrosTotal>=13 && tiros>=1){
		return 1; }
	
	//CONTINUAR (ARRISCAR)
	if(cerebrosParcial==1 && tiros==2){
		return 0; }

	//CONTINUAR (ARRISCAR)
	if(cerebrosParcial==2 && tiros==2 && (rand()%2)==0){
		return 0; }

	//PARAR (SALVAR CEREBROS)
	if(cerebrosParcial>=5 && tiros>=1){
		return 1; }

	//PARAR (SALVAR CEREBROS)
	if(cerebrosParcial>=1 && tiros>=2){
		return 1; }

	//CONTINUAR (ARRISCAR)
	if(cerebrosParcial<=0){
		return 0; }

	//CONTINUAR (DEFAULT)
	return 0;
}
//############################################################################################################################################

//############################################################################################################################################
int Jogador::getCerebrosTotal(){
	return this->cerebrosTotal; 
}
//############################################################################################################################################

//############################################################################################################################################
int Jogador::getCerebrosParcial(){
	return this->cerebrosParcial; 
}
//############################################################################################################################################

//############################################################################################################################################
int Jogador::getTiros(){
	return this->tiros; 
}
//############################################################################################################################################

//############################################################################################################################################
int Jogador::getVida(){
	return this->vida;
}
//############################################################################################################################################

//############################################################################################################################################
void Jogador::setCerebrosTotal(int valor){
	this->cerebrosTotal=valor;
}
//############################################################################################################################################

//############################################################################################################################################
void Jogador::setCerebrosParcial(int valor){
	this->cerebrosParcial=valor;
}
//############################################################################################################################################

//############################################################################################################################################
void Jogador::setTiros(int valor){
	this->tiros=valor;
}
//############################################################################################################################################

//############################################################################################################################################
void Jogador::setVida(int valor){
	this->vida=valor;
}
//############################################################################################################################################




